{% for key, src in sources.items() %}
expression {{ key }} = ```
{% if src.kind == 'snowflake' %}
{% include 'sources/snowflake.j2' %}
{% elif src.kind == 'excel' %}
{% include 'sources/excel.j2' %}
{% else %}
{# Fallback for unknown source types #}
	let
	    Source = error "Unsupported source kind: {{ src.kind }}"
	in
	    Source
{% endif %}

			```
	lineageTag: {{ generate_lineage_tag() }}

	annotation PBI_IncludeFutureArtifacts = False
{% if not loop.last %}

{% endif %}
{% endfor %}

{% if transforms %}
{% for func_name, body in transforms.items() %}

expression {{ func_name }} = ```
	{{ body }}
	```
	lineageTag: {{ generate_lineage_tag() }}
	
	annotation PBI_ResultType = Function

{% endfor %}
{% endif %}


